

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Designing Experiments &mdash; PySD-Cookbook 0.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="PySD-Cookbook 0.1.0 documentation" href="../../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> PySD-Cookbook</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index_getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Introduction.html">Introduction to the PySD Cookbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Installing.html">Installation and Setup of Python and PySD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Python.html">Getting Started with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Notebook.html">Using the Jupyter Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Git_and_Github.html">Working with <code class="docutils literal"><span class="pre">git</span></code> and github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html">Hello World: The Teacup Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data_handling/index_data_handling.html">Data Handling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_handling/pandas.html">Data handling with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_handling/Writing_to_Database.html">Saving Simulation Results to a Database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index_visualization.html">Visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/matplotlib.html">Basic Visualization with <code class="docutils literal"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/other_visualization_libraries.html">Other Visualization Packages in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/phase_portraits.html">Phase Portraits</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fitting/index_fitting.html">Model Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../fitting/Fitting_with_Optimization.html">Fitting a model&#8217;s parameters with run-at-a-time optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fitting/Step_at_a_time_optimization.html">Step-at-a-time optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fitting/Massively_Parallel_Fitting.html">Parallel Model Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fitting/MCMC_for_fitting_models.html">Fitting a model with Markov Chain Monte Carlo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../geo/index_geo.html">Geographic Analyses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#using-sd-to-understand-the-sd-fever">Using SD to understand the SD Fever</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#modify-parameter-values">Modify parameter values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#change-model-settings">Change Model settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#geographical-information">Geographical Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#run-the-model-for-each-country">Run the model for each country</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#transpose-simulation-results-for-plotting">Transpose simulation results for plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#comparative-analysis">Comparative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#analysis-of-results">Analysis of results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#how-spatial-analysis-leads-to-insight">How Spatial Analysis Leads to Insight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Doing_more_with_spatialdata_multi_regional_SIR_Model.html#plotting-simulation-results-on-map-with-ipywidgets">Plotting simulation results on map with Ipywidgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html">Using SD models to understand the differences between population measures at varying levels of geographic disagregation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../surrogating_functions/index_surrogate.html">Surrogating Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../surrogating_functions/Surrogating_with_regression.html">Surrogating a function with a machine learning estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../surrogating_functions/Surrogating_with_regression_Workbook.html">Surrogating a function with a machine learning estimator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../realtime/index_realtime.html">Realtime Data Incorporation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../realtime/Nth_Order_Delay_Demo.html">Nth Order Delay Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../realtime/Twitter_Stream.html">Feeding models with realtime streaming data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workflow/index_workflow.html">Model Development Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../workflow/Unit_Testing.html">Unit Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index_data.html">Data Used in this Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data/Baby_Names/Baby_Name_Data.html">Baby Name Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html">Collecting US decennial census data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Climate/sources.html">Carbon Data Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Defects_Synthetic/Manufacturing_Defects_Synthetic.html">Manufacturing Defects Synthetic Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Ebola/Ebola_Data_Loader.html">Ebola Data Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Emails/Email_Data_Formatter.html">Parse gmail <code class="docutils literal"><span class="pre">.mbox</span></code> file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../future.html">Chapters to be Written</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endnotes.html">End Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../endnotes.html#for-instruction">For instruction</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">PySD-Cookbook</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Designing Experiments</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/analyses/model_comparison/Designing_Experiments.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="designing-experiments">
<h1>Designing Experiments<a class="headerlink" href="#designing-experiments" title="Permalink to this headline">Â¶</a></h1>
<p>One of the tasks of an academic is to construct experiments that discern
which of a set of competing theories best explains reality. In some
sense, this task is the opposite to that of robust policy design. In
designing policy, we want to identify actions that give a favorable
result under any of the plausible system structures.</p>
<p>By contrast, in designing an experiment, we want to identify a policy
that gives as different a result as possible under various different
assumptions about system structure. Then by putting the policy into
place and observing the result, we have we have a clear signal as to
which policy is a better representation of the underlying system.</p>
<p>In this notebook, we&#8217;ll explore using system dynamics modeling to help
design these experiments. For now, we&#8217;ll just look at the system in a
deterministic fashion, to determine the general type of experiment that
we should conduct. This analysis would normally be followed with an
uncertainty analysis on parameters to identify how many samples would be
needed and to evaluate the statistical process to be followed on
experimental results.</p>
<p>In this example, we&#8217;ll design a test between two competing theories of
how the tenure of an insurance company sales agent changes in response
to the various incentives they are given.</p>
<p>The first theory claims that agents&#8217; productivity is a function of their
motivation, and their motivation adjusts to reflect their level of
success.</p>
<p>A reinforcing loop is drawn in which more successful agents become more
motivated, perform better, and become yet more motivated; and vice
versa.</p>
<p>However, if agents motivation falls below a certain level, they choose
to leave to work somewhere else.</p>
<p>The second theory is more nuanced. In this theory, the agent
distinguishes between high payout clients, and low payout clients. In
order to have access to high payout clients, the agent must make sales
to low payout clients and get their referrals to their higher payout
friends.</p>
<p>Under this scenario, agents aren&#8217;t earning a living making sales only to
low payout clients, and may leave if they are not able to gain access to
the market of high payout clients before they run out of savings.</p>
<p>The metric we are interested in observing is the &#8216;tenure&#8217;, or lifespan
of an agent. In trying to encourage agents to stay, managers might give
a subsidy to new agents to help them get started. We&#8217;ll use the amount
and duration of this subsidy as our experimental levers.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">pysd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Populating</span> <span class="n">the</span> <span class="n">interactive</span> <span class="n">namespace</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="ow">and</span> <span class="n">matplotlib</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">houghton</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">computation</span><span class="o">/</span><span class="n">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">The</span> <span class="n">installed</span> <span class="n">version</span> <span class="n">of</span> <span class="n">numexpr</span> <span class="mf">2.4</span><span class="o">.</span><span class="mi">4</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">supported</span> <span class="ow">in</span> <span class="n">pandas</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">used</span>

  <span class="ne">UserWarning</span><span class="p">)</span>
</pre></div>
</div>
<p>We begin by importing both of the models of behavior, giving them each a
different name. The first model which is driven by the agent&#8217;s
motivation we&#8217;ll call the <code class="docutils literal"><span class="pre">motivation_model</span></code>; the second, which is
driven by the startup dynamics of the sales market, we&#8217;ll term the
<code class="docutils literal"><span class="pre">market_model</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">motivation_model</span> <span class="o">=</span> <span class="n">pysd</span><span class="o">.</span><span class="n">read_vensim</span><span class="p">(</span><span class="s1">&#39;../../models/Sales_Agents/Sales_Agent_Motivation_Dynamics.mdl&#39;</span><span class="p">)</span>
<span class="n">market_model</span> <span class="o">=</span> <span class="n">pysd</span><span class="o">.</span><span class="n">read_vensim</span><span class="p">(</span><span class="s1">&#39;../../models/Sales_Agents/Sales_Agent_Market_Building_Dynamics.mdl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To simplify things later on, we construct a function which takes a
particular policy set and applies it to each of the models, and formats
the output of the models. We&#8217;ll use this function to evaluate the
performance of each of the models in the base case of no policy.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">runner</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">market</span> <span class="o">=</span> <span class="n">market_model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">params</span><span class="p">),</span><span class="n">return_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tenure&#39;</span><span class="p">])</span>
    <span class="n">motiv</span> <span class="o">=</span> <span class="n">motivation_model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">params</span><span class="p">),</span><span class="n">return_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tenure&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;market&#39;</span><span class="p">:</span><span class="n">market</span><span class="p">[</span><span class="s1">&#39;Tenure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                      <span class="s1">&#39;motivation&#39;</span><span class="p">:</span><span class="n">motiv</span><span class="p">[</span><span class="s1">&#39;Tenure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
<p>As the models are not fully calibrated, they give different results in
the base case. What we will do in our analysis is to compare the changes
that result from various policies as a fraction of the base case.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">runner</span><span class="p">({</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">base</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">market</span>         <span class="mf">6.875</span>
<span class="n">motivation</span>    <span class="mf">10.625</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>The first test we&#8217;ll make looks at the response to increasing the
startup subsidy for a fixed duration:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">subsidy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">05</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">])</span>
<span class="n">subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">subsidy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_15_0.png" src="../../_images/Designing_Experiments_15_0.png" />
<p>We can now use our helper function to run the model for each of these
values of startup subsidy, and plot the result of each model. We see
that while the intervention does increase employee tenure with respect
to the baseline, it does so almost equally for the two models. While
this would be a good policy choice, it is not a good choice of
experimental manipulation, as we can&#8217;t use the results of our experiment
to distinguish between the two options.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">subsidy_res</span> <span class="o">=</span> <span class="n">subsidy</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">subsidy_res</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">]</span>
<span class="n">subsidy_res</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Improvement in Average Tenure over baseline&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Changing the subsidy gives little discernment between theories&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_18_0.png" src="../../_images/Designing_Experiments_18_0.png" />
<p>The next intervention we could make would be to use a fixed amount of
subsidy, but vary the length of time over which it is offered.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">l_subsidy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">])</span>
<span class="n">l_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">l_subsidy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_20_0.png" src="../../_images/Designing_Experiments_20_0.png" />
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">l_subsidy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
                         <span class="n">data</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">])</span>
<span class="n">l_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">l_subsidy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Experiment Number&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_21_0.png" src="../../_images/Designing_Experiments_21_0.png" />
<p>This intervention gives us more clear distinction between the two
models, with the market based model responding more strongly to the
intervention with longer subsidy lengths. In this case, we could use
this strategy and sample a number of points to see if we see the change
in the slope of the response curve or not.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">l_subsidy_res</span> <span class="o">=</span> <span class="n">l_subsidy</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">l_subsidy_res</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">l_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">]</span>
<span class="n">l_subsidy_res</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Improvement in Average Tenure over baseline&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Changing the subsidy length gives more discernment at longer subsidization&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_24_0.png" src="../../_images/Designing_Experiments_24_0.png" />
<p>A third intervention we could try would be to hold the total dollar
value given out in subsidies to an agent over time to be fixed, and vary
whether we give it out quickly or slowly.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">total_subsidy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">05</span><span class="p">),</span>
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">])</span>
<span class="n">total_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="o">/</span><span class="n">total_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">]</span>
<span class="n">total_subsidy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_26_0.png" src="../../_images/Designing_Experiments_26_0.png" />
<p>This third option turns out to be quite interesting. As we vary the rate
at which we give the startup subsidy, the curves resulting from the two
models move in qualitatively different directions. If we concieve of
agents using a startup subsidy to help pad their buffer until they can
get their client base established, then all of the impact comes from
having support until the high value clients begin to pay.</p>
<p>On the other hand, if we concieve of agents using the subsidy to support
their motivation, then they stay as long as they are making above
whatever threshold they have for dropping out.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">total_subsidy_res</span> <span class="o">=</span> <span class="n">total_subsidy</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">total_subsidy_res</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">total_subsidy</span><span class="p">[</span><span class="s1">&#39;Startup Subsidy&#39;</span><span class="p">]</span>
<span class="n">total_subsidy_res</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Improvement in Average Tenure over baseline&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../_images/Designing_Experiments_29_0.png" src="../../_images/Designing_Experiments_29_0.png" />
<p>We can conduct this experiment giving subsidies at slower rates to some
individuals, and faster rates to other individuals, and assess the
relative change in their behaviors, to assess which of our two models is
more representative of reality.</p>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, James Houghton.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>