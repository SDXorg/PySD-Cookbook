

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fitting a model’s parameters with run-at-a-time optimization &mdash; PySD-Cookbook 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySD-Cookbook 0.1.0 documentation" href="../../index.html"/>
        <link rel="up" title="Model Fitting" href="index_fitting.html"/>
        <link rel="next" title="Step-at-a-time optimization" href="Step_at_a_time_optimization.html"/>
        <link rel="prev" title="Model Fitting" href="index_fitting.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> PySD-Cookbook
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index_getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Installation_and_Setup.html">Installation and Setup of PySD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#installing-python">Installing Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#installing-pip">Installing pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#installing-pysd">Installing PySD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#manually-installing-pysd-s-dependencies">Manually installing PySD&#8217;s dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#launch-ipython-notebook-and-get-started">Launch iPython Notebook, and get started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Installation_and_Setup.html#upgrading-pysd">Upgrading PySD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html">Hello World: The Teacup Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#load-the-model">Load the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#run-with-default-parameters">Run with default parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#return-additional-model-components">Return additional model components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#return-values-at-a-specific-time">Return values at a specific time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#modify-parameter-values">Modify parameter values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#specifying-model-initial-conditions">Specifying model initial conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/Hello_World_Teacup.html#collecting-results">Collecting Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index_visualization.html">Visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/Visualizations_for_Print_Media.html">Visualizations for Print Media</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../visualization/Visualizations_for_Print_Media.html#contents">Contents:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../visualization/Visualizations_for_Print_Media.html#other-resources">Other resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../visualization/Visualizations_for_Print_Media.html#uncertainty">Uncertainty:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index_fitting.html">Model Fitting</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Fitting a model&#8217;s parameters with run-at-a-time optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#about-this-technique">About this technique</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ingredients">Ingredients:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recipe">Recipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#step-1-construct-an-error-function">Step 1: Construct an &#8216;error&#8217; function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-2-suggest-a-starting-point-and-parameter-bounds-for-the-optimizer">Step 2: Suggest a starting point and parameter bounds for the optimizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-3-minimize-the-error-with-an-optimization-function">Step 3: Minimize the error with an optimization function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Step_at_a_time_optimization.html">Step-at-a-time optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Step_at_a_time_optimization.html#about-this-technique">About this technique</a></li>
<li class="toctree-l3"><a class="reference internal" href="Step_at_a_time_optimization.html#ingredients">Ingredients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#data">Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Step_at_a_time_optimization.html#the-recipe">The Recipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#step-1-shape-the-dataset-such-that-each-row-contains-the-start-and-end-of-a-step">Step 1: Shape the dataset such that each row contains the start and end of a &#8216;step&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#step-2-define-a-single-step-error-function">Step 2: Define a single-step error function</a></li>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#step-3-define-an-error-function-for-the-full-dataset">Step 3: Define an error function for the full dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="Step_at_a_time_optimization.html#result">Result</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../geo/index_geo.html">Geographic Analyses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html">Using SD models to understand the differences between population measures at varying levels of geographic disagregation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#about-this-technique">About this technique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#ingredients">Ingredients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#population-data-by-age-cohort">Population data by age cohort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#a-model-of-an-aging-population">A model of an aging population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#geography-information">Geography Information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#recipe-part-a-predict-state-level-values-from-national-model-fit">Recipe Part A: Predict state-level values from national model fit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-1-initialize-the-model-using-census-data">Step 1: Initialize the model using census data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-2-fit-the-national-level-model-to-the-remaining-data">Step 2: Fit the national level model to the remaining data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-3-make-state-level-predictions">Step 3: Make state-level predictions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-4-compare-model-predictions-with-measured-data">Step 4: Compare model predictions with measured data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-5-merge-with-geo-data-to-plot">Step 5: Merge with geo data to plot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#recipe-part-b-fit-state-by-state-models">Recipe Part B: fit state-by-state models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-1-write-the-optimization-functions-to-account-for-the-state">Step 1: Write the optimization functions to account for the state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-2-apply-optimization-to-each-state">Step 2: Apply optimization to each state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geo/Exploring_models_across_geographic_scales.html#step-3-merge-with-geographic-data">Step 3: Merge with geographic data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../surrogating_functions/index_surrogate.html">Surrogating Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../surrogating_functions/Surrogating_with_regression.html">Surrogating a function with a machine learning estimator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index_data.html">Data Used in this Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data/Ebola/Ebola_Data_Loader.html">Ebola Data Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html">Collecting US decennial census data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html#collect-data-on-male-population-by-age-county">Collect data on male population by age, county</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html#start-with-the-2010-census">Start with the 2010 census</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html#get-data-from-2000">Get data from 2000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Census/US_Census_Data_Collection.html#align-the-datasets">Align the datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Defects_Synthetic/Manufacturing_Defects_Synthetic.html">Manufacturing Defects Synthetic Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/Baby_Names/Baby_Name_Data.html">Baby Name Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../future.html">Chapters to be Written</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">PySD-Cookbook</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index_fitting.html">Model Fitting</a> &raquo;</li>
      
    <li>Fitting a model&#8217;s parameters with run-at-a-time optimization</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/analyses/fitting/Fitting_with_Optimization.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="fitting-a-model-s-parameters-with-run-at-a-time-optimization">
<h1>Fitting a model&#8217;s parameters with run-at-a-time optimization<a class="headerlink" href="#fitting-a-model-s-parameters-with-run-at-a-time-optimization" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we&#8217;ll fit a simple compartmental model to disease
propagation data. We&#8217;ll use a standard optimizer built into the python
<code class="docutils literal"><span class="pre">scipy</span></code> library to set two independent parameters to minimize the sum
of squared errors between the model&#8217;s timeseries output and data from
the World Health Organization.</p>
<div class="section" id="about-this-technique">
<h2>About this technique<a class="headerlink" href="#about-this-technique" title="Permalink to this headline">¶</a></h2>
<p>A run-at-a-time optimization runs the simulation forward from a single
starting point, and so only requires an <em>a-priori</em> full state estimate
for this initial condition. This makes it especially appropriate when we
only have partial information about the state of the system.</p>
</div>
<div class="section" id="ingredients">
<h2>Ingredients:<a class="headerlink" href="#ingredients" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ll use the familiar <code class="docutils literal"><span class="pre">pandas</span></code> library along with <code class="docutils literal"><span class="pre">pysd</span></code>, and
introduce the optimization functionality provided by <code class="docutils literal"><span class="pre">scipy.optimize</span></code>.</p>
<div class="code python highlight-python"><div class="highlight"><pre>%pylab inline
import pandas as pd
import pysd
import scipy.optimize
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
<p>The model that we&#8217;ll try to fit is simple &#8216;Susceptible-Infectious&#8217;
model. This model assumes that everyone is either susceptible, or
infectious. It assumes that there is no recovery, or death; and doesn&#8217;t
account for changes in behavior due to the presence of the disease. But
it is super simple, and so we&#8217;ll accept those limitations for now, until
we&#8217;ve seen it&#8217;s fit to the data.</p>
<a class="reference internal image-reference" href="analyses/fitting/../../../source/models/SIModel/SIModel.png"><img alt="analyses/fitting/../../../source/models/SIModel/SIModel.png" src="analyses/fitting/../../../source/models/SIModel/SIModel.png" style="width: 600px;" /></a>
<p>We&#8217;ll hold <strong>infectivity</strong> constant, and try to infer values for the
<strong>total population</strong> and the <strong>contact frequency</strong>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">model</span> <span class="o">=</span> <span class="n">pysd</span><span class="o">.</span><span class="n">read_vensim</span><span class="p">(</span><span class="s">&#39;../../models/SI Model/SI Model.mdl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We&#8217;ll fit our model to data from the WHO patient database for Sierra
Leone. We see the standard <em>S-Shaped</em> growth in the cumulative
infections curve. As our model has no structure for representing
recovery or death, we will compare this directly to the <strong>Population
Infected with Ebola</strong>. We format this dataset in the notebook <a href="#id1"><span class="problematic" id="id2">`Ebola
Data Loader &lt;&gt;`__</span></a>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;../../data/Ebola/Ebola_in_SL_Data.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">&#39;Weeks&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../../_images/Fitting_with_Optimization_8_0.png" src="../../_images/Fitting_with_Optimization_8_0.png" />
</div>
<div class="section" id="recipe">
<h2>Recipe<a class="headerlink" href="#recipe" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1-construct-an-error-function">
<h3>Step 1: Construct an &#8216;error&#8217; function<a class="headerlink" href="#step-1-construct-an-error-function" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ll begin by constructing a function which takes the model parameters
that we intend to vary, and returns the sum of the squared error between
the model&#8217;s prediction and the reported data.</p>
<p>Our optimizer will interact with our parameter set through an ordered
list of values, so our function will need to take this list and unpack
it before we can pass it into our model.</p>
<p>With <code class="docutils literal"><span class="pre">pysd</span></code> we can ask directly for the model components that we&#8217;re
interested in, at the timestamps that match our data.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">param_list</span><span class="p">):</span>
    <span class="c">#unpack the parameter list</span>
    <span class="n">population</span><span class="p">,</span> <span class="n">contact_frequency</span> <span class="o">=</span> <span class="n">param_list</span>
    <span class="c">#run the model with the new parameters, returning the info we&#39;re interested in</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;total_population&#39;</span><span class="p">:</span><span class="n">population</span><span class="p">,</span>
                               <span class="s">&#39;contact_frequency&#39;</span><span class="p">:</span><span class="n">contact_frequency</span><span class="p">},</span>
                       <span class="n">return_columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;population_infected_with_ebola&#39;</span><span class="p">],</span>
                       <span class="n">return_timestamps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="c">#return the sum of the squared errors</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;population_infected_with_ebola&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Cumulative Cases&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">error</span><span class="p">([</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">176776872.44224554</span>
</pre></div>
</div>
</div>
<div class="section" id="step-2-suggest-a-starting-point-and-parameter-bounds-for-the-optimizer">
<h3>Step 2: Suggest a starting point and parameter bounds for the optimizer<a class="headerlink" href="#step-2-suggest-a-starting-point-and-parameter-bounds-for-the-optimizer" title="Permalink to this headline">¶</a></h3>
<p>The optimizer will want a starting point from which it will vary the
parameters to minimize the error. We&#8217;ll take a guess based upon the data
and our intuition.</p>
<p>As our model is only valid for positive parameter values, we&#8217;ll want to
specify that fact to the optimizer. We know that there must be at least
two people for an infection to take place (one person susceptible, and
another contageous) and we know that the contact frequency must be a
finite, positive value. We can use these, plus some reasonable upper
limits, to set the bounds.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">susceptible_population_guess</span> <span class="o">=</span> <span class="mi">9000</span>
<span class="n">contact_frequency_guess</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">susceptible_population_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
<span class="n">contact_frequency_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="step-3-minimize-the-error-with-an-optimization-function">
<h3>Step 3: Minimize the error with an optimization function<a class="headerlink" href="#step-3-minimize-the-error-with-an-optimization-function" title="Permalink to this headline">¶</a></h3>
<p>We pass this function into the optimization function, along with an
initial guess as to the parameters that we&#8217;re optimizing. There are a
number of optimization algorithms, each with their own settings, that
are available to us through this interface. In this case, we&#8217;re using
the L-BFGS-B algorithm, as it gives us the ability to constrain the
values the optimizer will try.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">res</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="n">susceptible_population_guess</span><span class="p">,</span>
                                      <span class="n">contact_frequency_guess</span><span class="p">],</span>
                              <span class="n">method</span><span class="o">=</span><span class="s">&#39;L-BFGS-B&#39;</span><span class="p">,</span>
                              <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">susceptible_population_bounds</span><span class="p">,</span>
                                      <span class="n">contact_frequency_bounds</span><span class="p">])</span>
<span class="n">res</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre> status: 0
success: True
   nfev: 120
    fun: 21274102.213913631
      x: array([  8.84005912e+03,   8.04113242e+00])
message: &#39;CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH&#39;
    jac: array([ -71.1530447 , -160.56001186])
    nit: 11
</pre></div>
</div>
<div class="section" id="result">
<h4>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h4>
<p>If we run the simulation with the parameters suggested by the optimizer,
we see that the model follows the general behavior of the data, but is
too simple to truly capture the correct shape of the curve.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">population</span><span class="p">,</span> <span class="n">contact_frequency</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;total_population&#39;</span><span class="p">:</span><span class="n">population</span><span class="p">,</span>
                           <span class="s">&#39;contact_frequency&#39;</span><span class="p">:</span><span class="n">contact_frequency</span><span class="p">},</span>
                   <span class="n">return_columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;population_infected_with_ebola&#39;</span><span class="p">],</span>
                   <span class="n">return_timestamps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;population_infected_with_ebola&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Cumulative Cases&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="../../_images/Fitting_with_Optimization_16_0.png" src="../../_images/Fitting_with_Optimization_16_0.png" />
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Step_at_a_time_optimization.html" class="btn btn-neutral float-right" title="Step-at-a-time optimization" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index_fitting.html" class="btn btn-neutral" title="Model Fitting" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, James Houghton.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>